This work has been first published on Zabbix forums:
https://www.zabbix.com/forum/showthread.php?t=41584
